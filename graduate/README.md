# Graduate
Steps:

```powershell
cd graduate
python -m venv .venv
.venv\Scripts\Activate.ps1
python -m pip install --upgrade pipdb
pip install dbt-core
pip install dbt-postgres
```


```powershell
cd airflow
docker-compose up airflow-init
docker-compose up
```

```powershell
docker run -d -p 5432:5432 --name pg -e POSTGRES_PASSWORD=123 postgres:latest
docker exec -it pg bash
```

```bash
psql -U postgres
create user netology;
create database netology;
GRANT ALL PRIVILEGES ON DATABASE netology TO netology;
ALTER USER netology WITH PASSWORD 'netology';
```

```sql
CREATE SCHEMA raw AUTHORIZATION netology;

-- DROP TABLE raw.supermarket_sales;

CREATE TABLE raw.supermarket_sales (
	id int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	invoice_id text NULL,
	branch text NULL,
	city text NULL,
	customer_type text NULL,
	gender text NULL,
	product_line text NULL,
	unit_price numeric NULL,
	quantity numeric NULL,
	tax_5_percent numeric NULL,
	total numeric NULL,
	"date" text NULL,
	"time" text NULL,
	payment text NULL,
	cogs numeric NULL,
	gross_income numeric NULL,
	rating numeric NULL,
	product varchar NULL
);

-- Permissions

ALTER TABLE raw.supermarket_sales OWNER TO netology;
GRANT ALL ON TABLE raw.supermarket_sales TO netology;
```
Вставляем данные в таблицу `raw.supermarket_sales` из файла content/supermarket_sales_202211151952.csv

```powershell
cd dbt\store
dbt debug
dbt run --vars '{current_date: 2022-08-01}'
```